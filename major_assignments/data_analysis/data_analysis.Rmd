---
title: "data_analysis"
author: "Isabelle Jensen"
date: "2024-11-21"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown
## Introduction
This project explores cast vote records (CVRs) from the Maryland 2024 primary elections to uncover trends, patterns, and insights into voter behavior. By examining these detailed voting records, we aim to answer several newsworthy questions about the electoral process, such as straight-ticket voting rates, undervoting in down-ballot races, and the influence of ballot styles on voter choices.

## Load libraries

Loading required libraries for this analysis.

```{r echo=FALSE, message=FALSE}
library(tidyverse)
library(janitor)
library(lubridate)
library(dplyr)
library(readxl)
```

## Load and Cleaning Data

In this section, describe the source of the data, write a basic data dictionary 
for data you are working with, and discuss any caveats or issues you discovered 
working with this data. 

This data is pretty huge, but this is a collection of all of the data if we were to want to load all of them.

```{r}
Alleghany <- read_excel("data/01_Allegany PP24 CVRs/01PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Alleghany")
AnneArundel <- read_excel("data/02_Anne Arundel PP24 CVRs/02PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Anne Arundel")
BaltimoreCity <- read_excel("data/03_Baltimore City PP24 CVRs/03PP24_Prov_CVR_SBE.xlsx") |>   mutate(County = "Baltimore City")
BaltimoreCounty <- read_excel("data/04_Baltimore County PP24 CVRs/04PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Baltimore County")
Calvert <- read_excel("data/05_Calvert PP24 CVRs/05PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Calvert")
Caroline <- read_excel("data/06_Caroline PP24 CVRs/06PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Caroline")
Carroll <- read_excel("data/07_Carroll PP24 CVRs/07PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Carroll")
Cecil <- read_excel("data/08_Cecil PP24 CVRs/08PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Cecil")
Charles <- read_excel("data/09_Charles PP24 CVRs/09PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Charles")
Dorchester <- read_excel("data/10_Dorchester PP24 CVRs/10PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Dorchester")
Frederick <- read_excel("data/11_Frederick PP24 CVRs/11PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Frederick")
Garrett <- read_excel("data/12_Garrett PP24 CVRs/12PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Garrett")
Harford <- read_excel("data/13_Harford PP24 CVRs/13PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Harford")
Howard <- read_excel("data/14_Howard PP24 CVRs/14PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Howard")
Kent <- read_excel("data/15_Kent PP24 CVRs/15PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Kent")
Montgomery <- read_excel("data/16_Montgomery PP24 CVRs/16PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Montgomery")
PG <- read_excel("data/17_Prince George's PP24 CVRs/17PP24_Prov_CVR_SBE.xlsx") |>
  mutate(County = "Prince George's")
QueenAnnes <- read_excel("data/18_Queen Annes PP24 CVRs/18PP24_Prov_CVR_SBE.xlsx") |>
  mutate(County = "Queen Anne's")
StMarys <- read_excel("data/19_St Marys PP24 CVRs/19PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "St Marys")
Somerset <- read_excel("data/20_Somerset PP24 CVRs/20PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Somerset")
Talbot <- read_excel("data/21_Talbot PP24 CVRs/21PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Talbot")
Washington <- read_excel("data/22_Washington PP24 CVRs/22PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Washington")
Wicomico <- read_excel("data/23_Wicomico PP24 CVRs/23PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Wicomico")
Worcester <- read_excel("data/24_Worcester PP24 CVRs/24PP24_Prov_CVR_SBE.xlsx") |> 
  mutate(County = "Worcester")
glimpse(Worcester)
  Worcester$`DEM President of the United States (1) (500001630101)`
  #24 counties total
```

## Questions to explore
1. What is the proportion of Straight-Ticket Voting?
2. What are the Undervoting Rates in Down-Ballot Races?
3. Are there certain Precincts that behave similarly due to some aspects?
4. How much Ballot Splitting can we see in the cast vote records?
5. What is the Impact of Ballot Style on Voting Patterns in Local Races?

## Deliverable 2 (week 12) - 10 percent: 
For a quick overlook of a few interesting counties in MD: 
* Alleghany county has 10,596 observations of 22 vars, 
* Baltimore City has 98,232 obsercations of 78 vars,
* Frederick County has 50,434 observations of 27 vars
* Howard County has 64,723 observations of 29 vars
* MoCo has 99,999 observations of 72 vars
* PG county has 99,999 observations of 76 vars
* Talbot county has 7,932 observations of 23 vars

It looks like the more rural/red(?) counties have less on their ballots and Cast Vote records. It seems like there were places with more seats on their ballots. 
One thing about this data is that there is so much of it for each county, especially
those that are more populated. To analyze our questions we would likely have to select
just a few counties for our analysis for sake of time and computing power. 
For Codes or definitions, everything seems to be straightforward, and races we are
unfamiliar with could be researched. We will probably work off of state-wide races like the Senate race and try to answer our questions based on what we have. 


Proportion of Straight Ticket Voting

```{r pressure, echo=FALSE}


####Allegheny####
glimpse(Alleghany)


Alleghanydem_columns <- names(Alleghany)[grepl("^DEM ", names(Alleghany))]
Alleghanyrep_columns <- names(Alleghany)[grepl("^REP ", names(Alleghany))]

# Add a classification column using ifelse
Alleghany <- Alleghany |>
  mutate(
    straight_ticket = ifelse(
      # Check if all DEM columns have valid votes and all REP columns are empty or invalid
      !apply(select(., Alleghanydem_columns) == "undervote" | select(., Alleghanydem_columns) == "overvote" | is.na(select(., Alleghanydem_columns)), 1, any) &
      apply(select(., Alleghanyrep_columns) == "undervote" | select(., Alleghanyrep_columns) == "overvote" | is.na(select(., Alleghanyrep_columns)), 1, all),
      "Democrat",
      ifelse(
        # Check if all REP columns have valid votes and all DEM columns are empty or invalid
        !apply(select(., Alleghanyrep_columns) == "undervote" | select(., Alleghanyrep_columns) == "overvote" | is.na(select(., Alleghanyrep_columns)), 1, any) &
        apply(select(., Alleghanydem_columns) == "undervote" | select(., Alleghanydem_columns) == "overvote" | is.na(select(., Alleghanydem_columns)), 1, all),
        "Republican",
        # Default to "Mixed" if neither condition is met
        "Mixed"
      )
    )
  )

# Summarize results grouped by a relevant variable (e.g., precinct)
summary_by_precinct <- Alleghany |>
  group_by(Precinct) |>
  filter(
    straight_ticket == "Democrat" |
    straight_ticket == "Republican" |
    straight_ticket == "Mixed"
  ) |>
  summarize(
    dem_count = sum(straight_ticket == "Democrat"),
    rep_count = sum(straight_ticket == "Republican"),
    mixed_count = sum(straight_ticket == "Mixed"),
    total_count = n()
  ) |>
  arrange(desc(total_count))

# View the summarized results
summary_by_precinct











Alleghanydem_columns <- names(Alleghany)[grepl("^DEM ", names(Alleghany))]
Alleghanyrep_columns <- names(Alleghany)[grepl("^REP ", names(Alleghany))]

# Debug: Check the selected columns
print(Alleghanydem_columns)
print(Alleghanyrep_columns)

# Calculate valid votes and classify straight-ticket vs mixed-party voters
Alleghany <- Alleghany %>%
  mutate(
    Alleghanydem_votes = rowSums(select(., all_of(Alleghanydem_columns)) %>%
                          mutate(across(everything(),
                                        ~ !is.na(.) & . != "undervote" & . != "overvote"))),
    Alleghanyrep_votes = rowSums(select(., all_of(Alleghanyrep_columns)) %>%
                          mutate(across(everything(),
                                        ~ !is.na(.) & . != "undervote" & . != "overvote"))),
    Alleghanystraight_ticket = case_when(
      Alleghanydem_votes > 0 & Alleghanyrep_votes == 0 ~ "Democrat",
      Alleghanyrep_votes > 0 & Alleghanydem_votes == 0 ~ "Republican",
      TRUE ~ "Mixed"
    )
  )

# Summarize the classification
Alleghanysummary_counts <- Alleghany %>%
  count(Alleghanystraight_ticket)

# View the results
print(Alleghanysummary_counts)


#Democrat	3389
#Mixed	6
#Republican	7201

#####Anne Arundel######

glimpse(AnneArundel)


AnneArundeldem_columns <- names(AnneArundel)[grepl("^DEM ", names(AnneArundel))]
AnneArundelrep_columns <- names(AnneArundel)[grepl("^REP ", names(AnneArundel))]

# Debug: Check the selected columns
print(AnneArundeldem_columns)
print(AnneArundelrep_columns)

# Calculate valid votes and classify straight-ticket vs mixed-party voters
AnneArundel <- AnneArundel %>%
  mutate(
    AnneArundeldem_votes = rowSums(select(., all_of(AnneArundeldem_columns)) %>%
                          mutate(across(everything(),
                                        ~ !is.na(.) & . != "undervote" & . != "overvote"))),
    AnneArundelrep_votes = rowSums(select(., all_of(AnneArundelrep_columns)) %>%
                          mutate(across(everything(),
                                        ~ !is.na(.) & . != "undervote" & . != "overvote"))),
    AnneArundelstraight_ticket = case_when(
      AnneArundeldem_votes > 0 & AnneArundelrep_votes == 0 ~ "Democrat",
      AnneArundelrep_votes > 0 & AnneArundeldem_votes == 0 ~ "Republican",
      TRUE ~ "Mixed"
    )
  )

# Summarize the classification
AnneArundelsummary_counts <- AnneArundel %>%
  count(AnneArundelstraight_ticket)

# View the results
print(AnneArundelsummary_counts)


#Democrat	54747
#Mixed	3377
#Republican	35442



#####Baltimore City######
glimpse(BaltimoreCity)


BaltimoreCitydem_columns <- names(BaltimoreCity)[grepl("^DEM ", names(BaltimoreCity))]
BaltimoreCityrep_columns <- names(BaltimoreCity)[grepl("^REP ", names(BaltimoreCity))]

# Debug: Check the selected columns
print(BaltimoreCitydem_columns)
print(BaltimoreCityrep_columns)

# Calculate valid votes and classify straight-ticket vs mixed-party voters
BaltimoreCity <- BaltimoreCity %>%
  mutate(
    BaltimoreCitydem_votes = rowSums(select(., all_of(BaltimoreCitydem_columns)) %>%
                          mutate(across(everything(),
                                        ~ !is.na(.) & . != "undervote" & . != "overvote"))),
    BaltimoreCityrep_votes = rowSums(select(., all_of(BaltimoreCityrep_columns)) %>%
                          mutate(across(everything(),
                                        ~ !is.na(.) & . != "undervote" & . != "overvote"))),
    BaltimoreCitystraight_ticket = case_when(
      BaltimoreCitydem_votes > 0 & BaltimoreCityrep_votes == 0 ~ "Democrat",
      BaltimoreCityrep_votes > 0 & BaltimoreCitydem_votes == 0 ~ "Republican",
      TRUE ~ "Mixed"
    )
  )

# Summarize the classification
BaltimoreCitysummary_counts <- BaltimoreCity %>%
  count(BaltimoreCitystraight_ticket)

# View the results
print(BaltimoreCitysummary_counts)


#Democrat	93660
#Mixed	44
#Republican	4528

####Baltimore County#####
glimpse(BaltimoreCounty)


BaltimoreCountydem_columns <- names(BaltimoreCounty)[grepl("^DEM ", names(BaltimoreCounty))]
BaltimoreCountyrep_columns <- names(BaltimoreCounty)[grepl("^REP ", names(BaltimoreCounty))]

# Debug: Check the selected columns
print(BaltimoreCountydem_columns)
print(BaltimoreCountyrep_columns)

# Calculate valid votes and classify straight-ticket vs mixed-party voters
BaltimoreCounty <- BaltimoreCounty %>%
  mutate(
    BaltimoreCountydem_votes = rowSums(select(., all_of(BaltimoreCountydem_columns)) %>%
                          mutate(across(everything(),
                                        ~ !is.na(.) & . != "undervote" & . != "overvote"))),
    BaltimoreCountyrep_votes = rowSums(select(., all_of(BaltimoreCountyrep_columns)) %>%
                          mutate(across(everything(),
                                        ~ !is.na(.) & . != "undervote" & . != "overvote"))),
    BaltimoreCountystraight_ticket = case_when(
      BaltimoreCountydem_votes > 0 & BaltimoreCountyrep_votes == 0 ~ "Democrat",
     BaltimoreCountyrep_votes > 0 & BaltimoreCountydem_votes == 0 ~ "Republican",
      TRUE ~ "Mixed"
    )
  )

# Summarize the classification
BaltimoreCountysummary_counts <- BaltimoreCounty %>%
  count(BaltimoreCountystraight_ticket)

# View the results
print(BaltimoreCountysummary_counts)


#Democrat	67065
#Mixed	77
#Republican	32857


####Frederick County######
glimpse(Frederick)


Frederickdem_columns <- names(Frederick)[grepl("^DEM ", names(Frederick))]
Frederickrep_columns <- names(Frederick)[grepl("^REP ", names(Frederick))]

# Debug: Check the selected columns
print(Frederickdem_columns)
print(Frederickrep_columns)

# Calculate valid votes and classify straight-ticket vs mixed-party voters
Frederick <- Frederick %>%
  mutate(
    Frederickdem_votes = rowSums(select(., all_of(Frederickdem_columns)) %>%
                          mutate(across(everything(),
                                        ~ !is.na(.) & . != "undervote" & . != "overvote"))),
    Frederickrep_votes = rowSums(select(., all_of(Frederickrep_columns)) %>%
                          mutate(across(everything(),
                                        ~ !is.na(.) & . != "undervote" & . != "overvote"))),
    Frederickstraight_ticket = case_when(
      Frederickdem_votes > 0 & Frederickrep_votes == 0 ~ "Democrat",
      Frederickrep_votes > 0 & Frederickdem_votes == 0 ~ "Republican",
      TRUE ~ "Mixed"
    )
  )

# Summarize the classification
Fredericksummary_counts <- Frederick %>%
  count(Frederickstraight_ticket)

# View the results
print(Fredericksummary_counts)

#Democrat	25747
#Mixed	4243
#Republican	20444


####Howard County######

glimpse(Howard)


Howarddem_columns <- names(Howard)[grepl("^DEM ", names(Howard))]
Howardrep_columns <- names(Howard)[grepl("^REP ", names(Howard))]

# Debug: Check the selected columns
print(Howarddem_columns)
print(Howardrep_columns)

# Calculate valid votes and classify straight-ticket vs mixed-party voters
Howard <- Howard %>%
  mutate(
    Howarddem_votes = rowSums(select(., all_of(Howarddem_columns)) %>%
                          mutate(across(everything(),
                                        ~ !is.na(.) & . != "undervote" & . != "overvote"))),
    Howardrep_votes = rowSums(select(., all_of(Howardrep_columns)) %>%
                          mutate(across(everything(),
                                        ~ !is.na(.) & . != "undervote" & . != "overvote"))),
    Howardstraight_ticket = case_when(
      Howarddem_votes > 0 & Howardrep_votes == 0 ~ "Democrat",
      Howardrep_votes > 0 & Howarddem_votes == 0 ~ "Republican",
      TRUE ~ "Mixed"
    )
  )

# Summarize the classification
Howardsummary_counts <- Howard %>%
  count(Howardstraight_ticket)

# View the results
print(Howardsummary_counts)

#Democrat	44704	
#Mixed	4130	
#Republican	15889	



#####Montgomery County####
glimpse(Montgomery)


Montgomerydem_columns <- names(Montgomery)[grepl("^DEM ", names(Montgomery))]
Montgomeryrep_columns <- names(Montgomery)[grepl("^REP ", names(Montgomery))]

# Debug: Check the selected columns
print(Montgomerydem_columns)
print(Montgomeryrep_columns)

# Calculate valid votes and classify straight-ticket vs mixed-party voters
Montgomery <- Montgomery %>%
  mutate(
    Montgomerydem_votes = rowSums(select(., all_of(Montgomerydem_columns)) %>%
                          mutate(across(everything(),
                                        ~ !is.na(.) & . != "undervote" & . != "overvote"))),
    Montgomeryrep_votes = rowSums(select(., all_of(Montgomeryrep_columns)) %>%
                          mutate(across(everything(),
                                        ~ !is.na(.) & . != "undervote" & . != "overvote"))),
    Montgomerystraight_ticket = case_when(
     Montgomerydem_votes > 0 & Montgomeryrep_votes == 0 ~ "Democrat",
      Montgomeryrep_votes > 0 & Montgomerydem_votes == 0 ~ "Republican",
      TRUE ~ "Mixed"
    )
  )

# Summarize the classification
Montgomerysummary_counts <- Montgomery %>%
  count(Montgomerystraight_ticket)

# View the results
print(Montgomerysummary_counts)

#Democrat	77529
#Mixed	5567
#Republican	16903



#####PG County#####
glimpse(PG)


PGdem_columns <- names(PG)[grepl("^DEM ", names(PG))]
PGrep_columns <- names(PG)[grepl("^REP ", names(PG))]

# Debug: Check the selected columns
print(PGdem_columns)
print(PGrep_columns)

# Calculate valid votes and classify straight-ticket vs mixed-party voters
PG <- PG %>%
  mutate(
    PGdem_votes = rowSums(select(., all_of(PGdem_columns)) %>%
                          mutate(across(everything(),
                                        ~ !is.na(.) & . != "undervote" & . != "overvote"))),
    PGrep_votes = rowSums(select(., all_of(PGrep_columns)) %>%
                          mutate(across(everything(),
                                        ~ !is.na(.) & . != "undervote" & . != "overvote"))),
    PGstraight_ticket = case_when(
     PGdem_votes > 0 & PGrep_votes == 0 ~ "Democrat",
      PGrep_votes > 0 & PGdem_votes == 0 ~ "Republican",
      TRUE ~ "Mixed"
    )
  )

# Summarize the classification
PGsummary_counts <- PG %>%
  count(PGstraight_ticket)

# View the results
print(PGsummary_counts)

#Democrat	92170	
#Mixed	1685	
#Republican	6144


#####Talbot County#####
glimpse(Talbot)


Talbotdem_columns <- names(Talbot)[grepl("^DEM ", names(Talbot))]
Talbotrep_columns <- names(Talbot)[grepl("^REP ", names(Talbot))]

# Debug: Check the selected columns
print(Talbotdem_columns)
print(Talbotrep_columns)

# Calculate valid votes and classify straight-ticket vs mixed-party voters
Talbot <- Talbot %>%
  mutate(
    Talbotdem_votes = rowSums(select(., all_of(Talbotdem_columns)) %>%
                          mutate(across(everything(),
                                        ~ !is.na(.) & . != "undervote" & . != "overvote"))),
    Talbotrep_votes = rowSums(select(., all_of(Talbotrep_columns)) %>%
                          mutate(across(everything(),
                                        ~ !is.na(.) & . != "undervote" & . != "overvote"))),
    Talbotstraight_ticket = case_when(
     Talbotdem_votes > 0 & Talbotrep_votes == 0 ~ "Democrat",
      Talbotrep_votes > 0 & Talbotdem_votes == 0 ~ "Republican",
      TRUE ~ "Mixed"
    )
  )

# Summarize the classification
Talbotsummary_counts <- Talbot %>%
  count(Talbotstraight_ticket)

# View the results
print(Talbotsummary_counts)

#Democrat	3917	
#Mixed	77	
#Republican	3938		



```

Undervote Coding

Montgomery

```{r}

glimpse(Montgomery)


Montgomery |>
  filter(
    `DEM President of the United States (4) (500001630104)` == "undervote" |
    `DEM President of the United States (6) (500001630106)` == "undervote" |
    `DEM President of the United States (8) (500001630108)` == "undervote"
  ) |>
  summarize(
    `Race 4` = sum(`DEM President of the United States (4) (500001630104)` == "undervote", na.rm = TRUE),
    `Race 6` = sum(`DEM President of the United States (6) (500001630106)` == "undervote", na.rm = TRUE),
    `Race 8` = sum(`DEM President of the United States (8) (500001630108)` == "undervote", na.rm = TRUE)
  )
5 +	61+	269	
#335 undervotes for president

Montgomery |>
  summarize(
    `Total DEM (4)` = sum(!is.na(`DEM President of the United States (4) (500001630104)`)),
    `Total DEM (6)` = sum(!is.na(`DEM President of the United States (6) (500001630106)`)),
    `Total DEM (8)` = sum(!is.na(`DEM President of the United States (8) (500001630108)`))
  )
2329 + 12548 + 62687
#77564

335/77564
#0.4% of all democratic presidential votes were undervotes


Montgomery |>
  filter(
    `REP President of the United States (4) (500001630204)` == "undervote" |
    `REP President of the United States (6) (500001630206)` == "undervote" |
    `REP President of the United States (8) (500001630208)` == "undervote"
  ) |>
  summarize(
    `REP Race 4` = sum(`REP President of the United States (4) (500001630204)` == "undervote", na.rm = TRUE),
    `REP Race 6` = sum(`REP President of the United States (6) (500001630206)` == "undervote", na.rm = TRUE),
    `REP Race 8` = sum(`REP President of the United States (8) (500001630208)` == "undervote", na.rm = TRUE)
  )
13	+0 +	348
#361 undervotes for Rep pres

Montgomery |>
  summarize(
    `Total REP (4)` = sum(!is.na(`REP President of the United States (4) (500001630204)`)),
    `Total REP (6)` = sum(!is.na(`REP President of the United States (6) (500001630206)`)),
    `Total REP (8)` = sum(!is.na(`REP President of the United States (8) (500001630208)`))
  )

435+0 +11988

361/12423
#2.9% undervotes for Rep president out of total votes


Montgomery |>
  filter(
    `DEM U.S. Senator (5000017641)` == "undervote" )|>
  summarize(
    Total = sum(`DEM U.S. Senator (5000017641)`  == "undervote", na.rm = TRUE),
  )
#897 senate dem undervotes

Montgomery |>
  summarize(
    totalvotes=sum(!is.na(`DEM U.S. Senator (5000017641)` )))
#Total senate dem votes 77564	

897/77564	
#1.2% undervote

```

Undervote Howard

```{r}

glimpse(Howard)


Howard |>
  filter(
    `DEM President of the United States (3) (500001630103)`  == "undervote" ) |>
  summarize(
    Count = sum(`DEM President of the United States (3) (500001630103)`  == "undervote", na.rm = TRUE)
  )
#231 undervotes for president

Howard |>
  summarize(
    Count = sum(!is.na( `DEM President of the United States (3) (500001630103)`))
  )
#44726	total dem pres votes

231/44726
#0.5% of all democratic presidential votes were undervotes


Howard |>
  filter(
    `REP President of the United States (3) (500001630203)`   == "undervote" ) |>
  summarize(
    Count = sum(`REP President of the United States (3) (500001630203)`   == "undervote", na.rm = TRUE)
  )
#512 undervotes for president

Howard |>
  summarize(
    Count = sum(!is.na(  `REP President of the United States (3) (500001630203)` ))
  )
#15901

512/15901
#3.2% undervote for president rep candidates


Howard |>
  filter(
   `DEM U.S. Senator (5000017641)`  == "undervote" ) |>
  summarize(
    Count = sum(`DEM U.S. Senator (5000017641)`  == "undervote", na.rm = TRUE)
  )
#967 undervotes for senate

Howard |>
  summarize(
    Count = sum(!is.na( `DEM U.S. Senator (5000017641)`))
  )
#44726	

927/44726
#2.1% undervote democrate senate race


Howard |>
  filter(
   `REP U.S. Senator (5000017642)`  == "undervote" ) |>
  summarize(
    Count = sum(`REP U.S. Senator (5000017642)`  == "undervote", na.rm = TRUE)
  )
#261	 undervotes for senate

Howard |>
  summarize(
    Count = sum(!is.na( `REP U.S. Senator (5000017642)`))
  )
#15901		

261/15901
#1.6% undervotes for rep senate

```





Frederick Undervotes
```{r}
glimpse(Frederick)


Frederick |>
  filter(
    `DEM President of the United States (6) (500001630106)`   == "undervote" ) |>
  summarize(
    Count = sum( `DEM President of the United States (6) (500001630106)`   == "undervote", na.rm = TRUE)
  )
#168 undervotes for president

Frederick |>
  summarize(
    Count = sum(!is.na(  `DEM President of the United States (6) (500001630106)` ))
  )
#25772		total dem pres votes

168/25772
#0.6% of all democratic presidential votes were undervotes


Frederick |>
  filter(
   `REP President of the United States (6) (500001630206)`    == "undervote" ) |>
  summarize(
    Count = sum( `REP President of the United States (6) (500001630206)`    == "undervote", na.rm = TRUE)
  )
#491 undervotes for president

Frederick |>
  summarize(
    Count = sum(!is.na(  `REP President of the United States (6) (500001630206)`  ))
  )
#20457		total rep pres votes

491/20457
#2.4% of all republican presidential votes were undervotes


Frederick |>
  filter(
   `DEM U.S. Senator (5000017641)`   == "undervote" ) |>
  summarize(
    Count = sum( `DEM U.S. Senator (5000017641)`    == "undervote", na.rm = TRUE)
  )
#471 undervotes for senates

Frederick |>
  summarize(
    Count = sum(!is.na(  `DEM U.S. Senator (5000017641)`  ))
  )
#25772	total dem senate votes

471/25772
#1.8% of all democratic senate votes were undervotes


Frederick |>
  filter(
   `REP U.S. Senator (5000017642)`      == "undervote" ) |>
  summarize(
    Count = sum( `REP U.S. Senator (5000017642)`      == "undervote", na.rm = TRUE)
  )
#442	 undervotes for senate

Frederick |>
  summarize(
    Count = sum(!is.na( `REP U.S. Senator (5000017642)`    ))
  )
#20457		total rep sebate votes

442/20457
#2.2% of all republican senate votes were undervotes


```




Baltimore City Undervotes
```{r}

glimpse(BaltimoreCity)


BaltimoreCity |>
  filter(
    `DEM President of the United States (2) (500001630102)` == "undervote" |
    `DEM President of the United States (7) (500001630107)`    == "undervote" ) |>
  summarize(
    `Race 2` = sum( `DEM President of the United States (2) (500001630102)` == "undervote", na.rm = TRUE),
    `Race 7` = sum( `DEM President of the United States (7) (500001630107)`  == "undervote", na.rm = TRUE)
  )
57+	1146	
#1203 undervotes for dem president

BaltimoreCity |>
  summarize(
    `Total DEM (2)` = sum(!is.na(`DEM President of the United States (2) (500001630102)`)),
    `Total DEM (7)` = sum(!is.na(`DEM President of the United States (7) (500001630107)` ))
  )
8430+	85254
# 93684

1203/93684
#1.3% of all democratic presidential votes were undervotes




BaltimoreCity |>
  filter(
   `REP President of the United States (2) (500001630202)` == "undervote" |
    `REP President of the United States (7) (500001630207)`    == "undervote" ) |>
  summarize(
    `Race 2` = sum( `REP President of the United States (2) (500001630202)` == "undervote", na.rm = TRUE),
    `Race 7` = sum( `REP President of the United States (7) (500001630207)`  == "undervote", na.rm = TRUE)
  )
0	+175		
#175 undervotes for rep president

BaltimoreCity |>
  summarize(
    `Total DEM (2)` = sum(!is.na(`REP President of the United States (2) (500001630202)`)),
    `Total DEM (7)` = sum(!is.na(`REP President of the United States (7) (500001630207)` ))
  )
0	+4090

# 4090
175/4090
#4.3% of all republican presidential votes were undervotes




BaltimoreCity |>
  filter(
  `DEM U.S. Senator (5000017641)`   == "undervote" ) |>
  summarize(
    Count = sum( `DEM U.S. Senator (5000017641)`    == "undervote", na.rm = TRUE)
  )
#3088 undervotes for senates

BaltimoreCity |>
  summarize(
    Count = sum(!is.na( `DEM U.S. Senator (5000017641)`  ))
  )
#93684	total dem senate votes

3088/93684
#3.3% of all democratic senate votes were undervotes


BaltimoreCity |>
  filter(
  `REP U.S. Senator (5000017642)`  == "undervote" ) |>
  summarize(
    Count = sum( `REP U.S. Senator (5000017642)`   == "undervote", na.rm = TRUE)
  )
#157 undervotes for rep senate

BaltimoreCity |>
  summarize(
    Count = sum(!is.na( `REP U.S. Senator (5000017642)` ))
  )
#4548		total rep senate votes

157/4548
#3.5% of all republican senate votes were undervotes


```




Undervotes Baltimore County
```{r}

glimpse(BaltimoreCounty)


BaltimoreCounty |>
  filter(
    `DEM President of the United States (1) (500001630101)` == "undervote" |
   `DEM President of the United States (2) (500001630102)`  == "undervote" |
   `DEM President of the United States (7) (500001630107)`   == "undervote"
  ) |>
  summarize(
    `Race 1` = sum( `DEM President of the United States (1) (500001630101)` == "undervote", na.rm = TRUE),
    `Race 2` = sum( `DEM President of the United States (2) (500001630102)` == "undervote", na.rm = TRUE),
    `Race 7` = sum(`DEM President of the United States (7) (500001630107)` == "undervote", na.rm = TRUE)
  )
18+	243+	70	
#331 undervotes for president

BaltimoreCounty |>
  summarize(
    `Total DEM (1)` = sum(!is.na(`DEM President of the United States (1) (500001630101)`)),
    `Total DEM (2)` = sum(!is.na(`DEM President of the United States (2) (500001630102)`)),
    `Total DEM (7)` = sum(!is.na(`DEM President of the United States (7) (500001630107)`))
  )
3565	+48222	+15297
#67084

331/67084
#0.5 percent of all dem votes for president were undervotes


BaltimoreCounty |>
  filter(
   `REP President of the United States (1) (500001630201)`  == "undervote" |
  `REP President of the United States (2) (500001630202)`    == "undervote" |
   `REP President of the United States (7) (500001630207)`      == "undervote"
  ) |>
  summarize(
    `Race 1` = sum( `REP President of the United States (1) (500001630201)`  == "undervote", na.rm = TRUE),
    `Race 2` = sum( `REP President of the United States (2) (500001630202)`   == "undervote", na.rm = TRUE),
    `Race 7` = sum(`REP President of the United States (7) (500001630207)`    == "undervote", na.rm = TRUE)
  )
0+	471	+72	
#543 undervotes for president

BaltimoreCounty |>
  summarize(
    `Total rep (1)` = sum(!is.na(`REP President of the United States (1) (500001630201)` )),
    `Total rep (2)` = sum(!is.na(`REP President of the United States (2) (500001630202)`  )),
    `Total rep (7)` = sum(!is.na(`REP President of the United States (7) (500001630207)` ))
  )

0	+21924 +5837
#27761

543/27761
#2% of all votes for rep president was an undervote



BaltimoreCounty |>
  filter(
  `DEM U.S. Senator (5000017641)`    == "undervote" ) |>
  summarize(
    Count = sum( `DEM U.S. Senator (5000017641)`    == "undervote", na.rm = TRUE)
  )
#1107 undervotes for senates

BaltimoreCounty |>
  summarize(
    Count = sum(!is.na( `DEM U.S. Senator (5000017641)`   ))
  )
#67084	total dem senate votes

1107/67084
#1.7% of all democratic senate votes were undervotes



BaltimoreCounty |>
  filter(
  `REP U.S. Senator (5000017642)`  == "undervote" ) |>
  summarize(
    Count = sum( `REP U.S. Senator (5000017642)`  == "undervote", na.rm = TRUE)
  )
#530	 undervotes for rep senate

BaltimoreCounty |>
  summarize(
    Count = sum(!is.na( `REP U.S. Senator (5000017642)`))
  )
#32915		total rep senate votes

530/32915
#1.6% of all republican senate votes were undervotes



```